# Лабораторная работа 11: Верификация Funny

[RU|[EN](README.md)]

Эта лабораторная работа является вершиной всего курса упражнений. Она дополняет лабораторные работах [09](../lab09/README.ru.md) и [10](../lab10/README.ru.md) для получения полного решения по синтаксическому анализу, компиляции, и верификации модулей Funny.

## Цель

В этой работе нам нужно провести верификацию корректности каждой функции, определенной в модуле Funny. Подробное описание процесса порождения условий корректности описано в лекциях по данному курсу.

После получения условий корректности для каждой функции получены, мы будем транслировать эти условия в *определение теоремы* на языке доказателя теорем Z3. Затем мы переложим тяжкий труд по доказательству этих теорем на Z3, получим от него результаты, и доложим их пользователю.

Если все сделано верно, то наш компилятор сможет обнаруживать ошибки реализации (несоответствие кода функций их спецификациям) и сообщать о них пользователю; и только верифицированный код будет компилироваться в Wasm для исполнения.

## Задачи

Доработайте файл [verifier.ts](src/verifier.ts) так, чтобы:

1. Реализовать функцию `buildFunctionVerificationConditions()` для порождения условий корректности
2. Реализовать функцию `convertConditionsToZ3()`, которая порождает на основе условий, представленных в виде предиката Funny, утверждение Z3
3. Реализовать функцию `proveTheorem` для вызова решателя Z3 с построенным на предыдущих шагах утверждением в качестве аргумента, и интерпретации результатов доказательства

## Оценка

- C | 3 | Воу, воу, полегче:
  - Реализуйте верификацию простых функций без циклов и  вызовов других функций, а также без кванторов и ссылок на формулы в аннотациях
- B | 4 | Ломай меня полностью:
  - Реализуйте верификацию функций, содержащих циклы или рекурсию; аннотации могут содержать кванторы
- A | 5 | Мне все ультрафиолетово:
  - Реализуйте поддержку ссылок на формулы в аннотациях
- A+ | 5+ | Покой нам только снится:
  - При обнаружении ошибки верификации, указывайте пользователю точное место нарушения
  - Добавьте поддержку верификации во время исполнения: если некоторые из условий верификации не удается ни доказать, ни опровергнуть, вставляйте в соответствуюшее место Wasm-код для проверки условия, который бросает исключение в случае его нарушения. При невозможности представления аннотации Wasm-кодом возвращайте пользователю ошибку верификации.
  